---
title: "*Spatial Statistics Lab 3*"
author: '**Onyedikachi J Okeke**'
date: "`r Sys.Date()`"
output:
  word_document: default
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### **0.0 To Load the Spatstat library**

```{r,echo=F,results='Show', fig.show='hold',eval=T}
library(spatstat)
```

## **Part 1: Simulation of homogeneous Poisson process**

```{r,comment="",echo=TRUE,eval=FALSE}
# A) To make a point pattern using one of these processes, type:
par(mfrow = c(2, 3))

pp <-rpoispp(100)
#plot pp
plot(pp)

# B) combine generating and plotting a pattern into a single command
plot(rpoispp(100))

# C) create the pattern first before plotting
p1 <-rpoispp(100)
plot(p1)

# D) repeatedly generate p1 and plot it, until getting an interesting realization of the process.

par(mfrow = c(2, 3))

p2 <- rpoispp(100)
plot(p2)

p3 <- rpoispp(100)
plot(p3)

p4 <- rpoispp(100)
plot(p4)

p5 <- rpoispp(100)
plot(p5)

p6 <- rpoispp(100)
plot(p6)


```
#### Result
```{r,echo=F,results='Show', fig.show='hold',eval=T}
# A) To make a point pattern using one of these processes, type:
par(mfrow = c(2, 3))

pp <-rpoispp(100)
#plot pp
plot(pp)

# B) combine generating and plotting a pattern into a single command
plot(rpoispp(100))

# C) create the pattern first before plotting
p1 <-rpoispp(100)
plot(p1)

# D) repeatedly generate p1 and plot it, until getting an interesting realization of the process.

par(mfrow = c(2, 3))

p2 <- rpoispp(100)
plot(p2)

p3 <- rpoispp(100)
plot(p3)

p4 <- rpoispp(100)
plot(p4)

p5 <- rpoispp(100)
plot(p5)

p6 <- rpoispp(100)
plot(p6)


# Create a sample spatial point pattern (replace with your own data)
set.seed(123)
n_points <- 100
x <- runif(n_points)
y <- runif(n_points)
data_points <- ppp(x, y, window = owin(c(0, 1), c(0, 1)))

```
Q1

Q2 how it is possible for such seemingly 'non-random' patterns to be generated by a completely random process

```{r,comment="",echo=TRUE,eval=FALSE}
# Q2 Create a sample spatial point pattern (replace with your own data)
set.seed(123)
n_points <- 100
x <- runif(n_points)
y <- runif(n_points)
data_points <- ppp(x, y, window = owin(c(0, 1), c(0, 1)))

# Plot the point pattern
plot(data_points, main = "Spatial Point Pattern")

# Perform a quadrat test to check for clustering
quadrat_test_result <- quadrat.test(data_points)

# Print the results of the quadrat test
print(quadrat_test_result)

# Interpret the results
if (quadrat_test_result$p.value < 0.05) {
  print("There is evidence of clustering.")
} else {
  print("There is no significant evidence of clustering.")
}

```
#### Result
```{r,echo=F,results='Show', fig.show='hold',eval=T}
# Q2 Create a sample spatial point pattern (replace with your own data)
set.seed(123)
n_points <- 100
x <- runif(n_points)
y <- runif(n_points)
data_points <- ppp(x, y, window = owin(c(0, 1), c(0, 1)))

# Plot the point pattern
plot(data_points, main = "Spatial Point Pattern")

# Perform a quadrat test to check for clustering
quadrat_test_result <- quadrat.test(data_points)

# Print the results of the quadrat test
print(quadrat_test_result)

# Interpret the results
if (quadrat_test_result$p.value < 0.05) {
  print("There is evidence of clustering.")
} else {
  print("There is no significant evidence of clustering.")
}
```

Q3 the different realizations of the same process under CSR.

```{r,comment="",echo=TRUE,eval=FALSE}
#Q3 generate a point pattern with intensity 1 in a 10 x 10 square
pp.1.10 <- rpoispp(1, win=owin(c(0,10),c(0,10)))
par(mfrow=c(1,2))

plot(rpoispp(100),main = "intensity = 100, unitsquare")  # uniform Poisson process with
#intensity 100 in the unit square
plot (pp.1.10, main = "intensity = 1, 10 x 10 square")

# redoing exactly same process
pp2.1.10 <- rpoispp(1, win=owin(c(0,10),c(0,10)))
par(mfrow=c(1,2))

plot(rpoispp(100),main = "intensity = 100, unitsquare")  # uniform Poisson process with
#intensity 100 in the unit square
plot (pp2.1.10, main = "intensity = 1, 10 x 10 square")


```
#### Result
```{r,echo=F,results='Show', fig.show='hold',eval=T}
#Q3 generate a point pattern with intensity 1 in a 10 x 10 square
pp.1.10 <- rpoispp(1, win=owin(c(0,10),c(0,10)))
par(mfrow=c(1,2))

plot(rpoispp(100),main = "intensity = 100, unitsquare")  # uniform Poisson process with
#intensity 100 in the unit square
plot (pp.1.10, main = "intensity = 1, 10 x 10 square")

# redoing exactly same process
pp2.1.10 <- rpoispp(1, win=owin(c(0,10),c(0,10)))
par(mfrow=c(1,2))

plot(rpoispp(100),main = "intensity = 100, unitsquare")  # uniform Poisson process with
#intensity 100 in the unit square
plot (pp2.1.10, main = "intensity = 1, 10 x 10 square")

```

Q4 Change the intensity parameter to 10,20, and 50 in the unit square

```{r,comment="",echo=TRUE,eval=FALSE}
#Q4 Change the intensity parameter to 10,20, and 50 in the unit square
# Set the seed for reproducibility
set.seed(123)

# Create a 10x10 square window
window_square <- owin(c(0, 10), c(0, 10))

#Generate and visualize three realizations of the same process under CSR
par(mfrow=c(1, 2))
for (i in 1:3) {
  pp_csr <- rpoispp(lambda = 1, win = window_square)
  plot(pp_csr, main = paste("Realization", i))
}

#Change the intensity parameter to 10, 20, and 50 in the unit square
par(mfrow=c(1, 2))
intensities <- c(10, 20, 50)
for (i in 1:3) {
  pp_intensity <- rpoispp(lambda = intensities[i], win = window_square)
  plot(pp_intensity, main = paste("Intensity =", intensities[i]))
}

```
#### Result
```{r,echo=F,results='Show', fig.show='hold',eval=T}

#Q4 Change the intensity parameter to 10,20, and 50 in the unit square
# Set the seed for reproducibility
set.seed(123)

# Create a 10x10 square window
window_square <- owin(c(0, 10), c(0, 10))

#Generate and visualize three realizations of the same process under CSR

par(mfrow=c(1, 2))
for (i in 1:3) {
  pp_csr <- rpoispp(lambda = 1, win = window_square)
  plot(pp_csr, main = paste("Realization", i))
}

#Change the intensity parameter to 10, 20, and 50 in the unit square
par(mfrow=c(1, 2))
intensities <- c(10, 20, 50)
for (i in 1:3) {
  pp_intensity <- rpoispp(lambda = intensities[i], win = window_square)
  plot(pp_intensity, main = paste("Intensity =", intensities[i]))
}

```

Q5 No, each simulation does not show exactly 10 points because Poisson point processes are stochastic, and the number of points in each realization can vary. The intensity parameter (lambda) represents the average number of points in a unit area, but the actual number of points in a specific realization follows a Poisson distribution with mean lambda. Therefore, there will be some variability in the number of points in each simulation.

## **Part 2: Simulation of inhomogeneous Poisson process**

```{r,comment="",echo=TRUE,eval=FALSE}
# A) define a function in place of the fixed intensity value of the standard Poisson process.
pp <- rpoispp(100)

# B) specify a function for the intensity
pp <- rpoispp(function(x,y) {100*x + 100*y})

par(mfrow=c(1, 2))
# C) To plot the density of points in each realization:
plot(density(pp))
plot(pp, add=T)

# D) Visualizing the density of each point process realization is using contours
plot(density(pp))
contour(density(pp), add=T)
plot(pp, add=T)


```
#### Result
```{r,echo=F,results='Show', fig.show='hold',eval=T}
# A) define a function in place of the fixed intensity value of the standard Poisson process.
pp <- rpoispp(100)

# B) specify a function for the intensity
pp <- rpoispp(function(x,y) {100*x + 100*y})

par(mfrow=c(1, 2))
# C) To plot the density of points in each realization:
plot(density(pp))
plot(pp, add=T)

# D) Visualizing the density of each point process realization is using contours
plot(density(pp))
contour(density(pp), add=T)
plot(pp, add=T)

```
Q6

#### Now change the intensity function

```{r,comment="",echo=TRUE,eval=FALSE}
#  E) with intensity lambda(x,y) = 100 * exp(-3*x)
# Intensity is bounded by 100
pp <- rpoispp(function(x,y) {100 * exp(-3*x)}, 100)
par(mfrow=c(1, 2))
# C) To plot the density of points in each realization:
plot(density(pp))
plot(pp, add=T)

# D) Visualizing the density of each point process realization is using contours
plot(density(pp))
contour(density(pp), add=T)
plot(pp, add=T)

```
#### Result
```{r,echo=F,results='Show', fig.show='hold',eval=T}
#  E) with intensity lambda(x,y) = 100 * exp(-3*x)
# Intensity is bounded by 100
pp <- rpoispp(function(x,y) {100 * exp(-3*x)}, 100)
par(mfrow=c(1, 2))
# C) To plot the density of points in each realization:
plot(density(pp))
plot(pp, add=T)

# D) Visualizing the density of each point process realization is using contours
plot(density(pp))
contour(density(pp), add=T)
plot(pp, add=T)

```
#### Redo the above statement 10 times and plot each realization (including density and point pattern on top)
```{r,comment="",echo=TRUE,eval=FALSE}
par(mfrow=c(1,2))  # Set up a 5x2 grid for 10 plots

for (i in 1:10) {
  # Generate a realization of the point process with a different intensity function
  pp <- rpoispp(function(x,y) {100 * exp(-3*x)}, 100)
  
  # Plot the density of points in each realization
  plot(density(pp))
  
  # Visualize the density using contours
  contour(density(pp), add=TRUE)
  
  # Plot the point process on top
  plot(pp, add=TRUE)
}

```
#### Result
```{r,echo=F,results='Show', fig.show='hold',eval=T}
par(mfrow=c(1,2))  # Set up a 5x2 grid for 10 plots

for (i in 1:10) {
  # Generate a realization of the point process with a different intensity function
  pp <- rpoispp(function(x,y) {100 * exp(-3*x)}, 100)
  
  # Plot the density of points in each realization
  plot(density(pp))
  
  # Visualize the density using contours
  contour(density(pp), add=TRUE)
  
  # Plot the point process on top
  plot(pp, add=TRUE)
}

```
Q7 Generating 10 different realizations of a point process with varying intensity functions illustrates the stochastic nature of spatial patterns and highlights the intrinsic randomness in Poisson point processes. Despite using a common intensity function as a guide, each realization produces a unique spatial distribution of points. While these realizations generally follow the expected pattern defined by the intensity function, they exhibit specific variations and characteristics. Some may display clustering in certain areas, while others appear more dispersed. This variability has significant implications for fields such as spatial statistics, ecology, epidemiology, and urban planning, where understanding and accounting for randomness is crucial. It emphasizes the need for multiple realizations to assess uncertainty, make statistical inferences, and evaluate the robustness of conclusions drawn from a single point pattern.

## **Part 3: Regular pattern point processes**

```{r,comment="",echo=TRUE,eval=FALSE}
help(spatstat)
```
#### Result
```{r,echo=F,results='Show', fig.show='hold',eval=T}
help(spatstat)
```
second-order interaction effects
```{r,comment="",echo=TRUE,eval=FALSE}
pp <- rSSI(0.05, 100)
```
#### Result
```{r,echo=F,results='Show', fig.show='hold',eval=T}
pp <- rSSI(0.05, 100)
```

Q8 Redoing the above statement 6 times and plot each realization.

```{r,comment="",echo=TRUE,eval=FALSE}
#Q8 Redoing the above statement 6 times and plot each realization
# Set up a 2x3 grid for 6 plots
par(mfrow=c(2, 3))

# Generate and plot 6 realizations
for (i in 1:6) {
  pp <- rSSI(0.05, 100)
  plot(pp, main = paste("Realization", i))
}
```
#### Result
```{r,echo=F,results='Show', fig.show='hold',eval=T}
#Q8 Redoing the above statement 6 times and plot each realization
# Set up a 2x3 grid for 6 plots
par(mfrow=c(2, 3))

# Generate and plot 6 realizations
for (i in 1:6) {
  pp <- rSSI(0.05, 100)
  plot(pp, main = paste("Realization", i))
}
```

Q9 Change the inhibition distance to 0.08 and number of events to 50

```{r,comment="",echo=TRUE,eval=FALSE}
#Q9 Change the inhibition distance to 0.08 and number of events to 50.
# Set up a 2x3 grid for 6 plots
par(mfrow=c(2, 3))

# Generate and plot 6 realizations
for (i in 1:6) {
  pp <- rSSI(0.08, 50)
  plot(pp, main = paste("Realization", i))
}

```
#### Result
```{r,echo=F,results='Show', fig.show='hold',eval=T}
#Q9 Change the inhibition distance to 0.08 and number of events to 50.
# Set up a 2x3 grid for 6 plots
par(mfrow=c(2, 3))

# Generate and plot 6 realizations
for (i in 1:6) {
  pp <- rSSI(0.08, 50)
  plot(pp, main = paste("Realization", i))
}

```

## Part 4: Clustering pattern point processes

```{r,comment="",echo=TRUE,eval=FALSE}
#contrast, a clustering process, such as the Thomas process
# Set up a 2x3 grid for 6 plots
par(mfrow=c(2, 3))

# Generate and plot 6 realizations
for (i in 1:6) {
  pp <- rThomas(10, 0.1, 10)
  plot(pp, main = paste("Realization", i))
}

```
#### Result
```{r,echo=F,results='Show', fig.show='hold',eval=T}
#contrast, a clustering process, such as the Thomas process
# Set up a 2x3 grid for 6 plots
par(mfrow=c(2, 3))

# Generate and plot 6 realizations
for (i in 1:6) {
  pp <- rThomas(10, 0.1, 10)
  plot(pp, main = paste("Realization", i))
}

```

